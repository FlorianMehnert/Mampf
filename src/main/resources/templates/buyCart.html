<!DOCTYPE html>

<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
  <!-- Bootstrap -->
  <!-- CSS -->
  <link rel="icon" type="image/vnd.microsoft.icon" th:href="@{/resources/img/cook_icon.ico}">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
    integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">

  <script th:src="@{/webjars/jquery/jquery.min.js}" src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
  <link rel="stylesheet" type="text/css" th:href="@{/resources/css/style.css}" />
  <!-- Bootstrap -->
  <!-- jQuery and JS bundle w/ Popper.js -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
    crossorigin="anonymous"></script>

  <title>Warenkorb</title>
</head>

<body>
  <nav th:include="navigation :: navigation"></nav>



  <div class="container" th:each="domain : ${domains}">
    <div class="row">
      <br>
      <h3 th:text="${domain.key}"></h3>
      <table class="table table-hover">
        <thead class="thead-light">
        <tr>
          <th>Titel</th>
          <th>Anzahl</th>
          <th>Preis</th>
        </tr>
        </thead>
        <tbody th:remove="all-but-first">
        <div th:with="cart=${domain.value}">
          <tr th:each="item : ${domain.value} ">
            <td th:text="${item.productName}"></td>
            <td th:text="${item.quantity.getAmount()}"></td>
            <td th:text="${{item.price}}"></td>
          </tr>
        </div>
        </tbody>
      </table>
    </div>
    <div class="row mt-3">
      <span th:text="${'Preis für '+ domain.key + ':  ' + total}"></span>
    </div>
  </div>
  <div class="container">

    <div class="row mt-3">
        <b th:text="${'Gesamtpreis: ' + total}"></b>
    </div>
    <div class="row mt-2">
      <form method="post" class="pb-2" style="position: relative; left: -3px" th:action="@{/cart/clear}">
        <button class="btn btn-outline-primary" style="top: 20px" type="submit">Warenkorb leeren</button>
      </form>
    </div>
    <div class="row mt-3">
      <h4>Bestellung abschließen</h4>
    </div>
    <div class="row mt-3">
      <form method="post" role="form" id="form" th:action="@{/checkout}" th:object="${form}">
        <div class="alert alert-danger alert-dismissible fade show" role="alert" th:if="${#fields.hasErrors('generalError')}">
          <strong>Bestellvorgang abgebrochen</strong>
          <span th:errors="*{generalError}"></span>
          <button type="button" class="close" data-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="invalid-feedback" >

        </div>
        <input type="hidden" name="domainChoosen" th:field="*{domainChoosen}" />
        <div class="form-check form-check-inline">
          <input id="barChecked" class="form-check-input" type="radio" name="payMethod" value="Bar" checked="checked" />
          <label for="barChecked" class="form-check-label">Bar</label>
        </div>
        <div class="form-check form-check-inline">
          <input id="checkChecked" class="form-check-input" type="radio" name="payMethod" value="Check" />
          <label for="checkChecked" class="form-check-label">Überweisung</label>
        </div>
        <div class="form-group mt-2">
          <label for="startDate">Datum:</label>
          <input id="startDate" class="form-control" th:classappend="${#fields.hasErrors('startDate')} ? 'is-invalid' : ''"
                 name="startDate" type="date" th:field="*{startDate}"/>
          <div class="invalid-feedback" th:if="${#fields.hasErrors('startDate')}" th:errors="*{startDate}">

          </div>
        </div>
        <div class="form-group mt-2">
          <label for="startTime">Uhrzeit:</label>
          <input id="startTime" class="form-control" th:classappend="${#fields.hasErrors('startTime')} ? 'is-invalid' : ''"
                 name="startDate" type="time" th:min="*{getToday()}" th:field="*{startTime}"/>
          <div class="invalid-feedback" th:if="${#fields.hasErrors('startTime')}" th:errors="*{startTime}">

          </div>
        </div>
        <button type="submit" class="btn btn-outline-primary">Bestellung erstellen</button>
      </form>

    </div>

  </div>
</div>
</body>

</html>