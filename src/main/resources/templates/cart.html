<!DOCTYPE html>

<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
  <!-- Bootstrap -->
  <!-- CSS -->
  <link rel="icon" type="image/vnd.microsoft.icon" th:href="@{/resources/img/World_sm_or.ico}">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
    integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">

  <script th:src="@{/webjars/jquery/jquery.min.js}" src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
  <link rel="stylesheet" type="text/css" th:href="@{/resources/css/style.css}" />
  <!-- Bootstrap -->
  <!-- jQuery and JS bundle w/ Popper.js -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
    crossorigin="anonymous"></script>

  <title>Warenkorb</title>
</head>

<body>
  <nav th:include="navigation :: navigation"></nav>
  <div class="container pb-5">
    <h1>Warenkorb</h1>
    <div>

      <div th:each="domain : ${domains}">
        <br>
        <h3 th:text="${domain.key}"></h3>

        <table class="table table-hover">
          <thead class="thead-light">
            <tr>
              <th>Titel</th>
              <th>Anzahl</th>
              <th>Preis</th>
              <th></th>
            </tr>
          </thead>
          <tbody th:remove="all-but-first">
            <div th:with="cart=${domain.value}">
              <tr th:each="item : ${domain.value} ">
                <td th:text="${item.productName}">Last Action Hero</td>
                <td>
                  <form class="form-inline" method="post" th:action="@{/cart/setNewAmount}">

                    <div class="input-group mb-3">
                      <input type="hidden" name="cartitemId" th:value="${item.id}" />
                      <input class="form-control" type="number" name="newAmount"
                        th:value="${item.quantity.getAmount()}">
                      <div class="input-group-append">
                        <button class="btn btn-outline-secondary" type="submit">
                          <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-arrow-repeat"
                            fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                            <path
                              d="M11.534 7h3.932a.25.25 0 0 1 .192.41l-1.966 2.36a.25.25 0 0 1-.384 0l-1.966-2.36a.25.25 0 0 1 .192-.41zm-11 2h3.932a.25.25 0 0 0 .192-.41L2.692 6.23a.25.25 0 0 0-.384 0L.342 8.59A.25.25 0 0 0 .534 9z" />
                            <path fill-rule="evenodd"
                              d="M8 3c-1.552 0-2.94.707-3.857 1.818a.5.5 0 1 1-.771-.636A6.002 6.002 0 0 1 13.917 7H12.9A5.002 5.002 0 0 0 8 3zM3.1 9a5.002 5.002 0 0 0 8.757 2.182.5.5 0 1 1 .771.636A6.002 6.002 0 0 1 2.083 9H3.1z" />
                          </svg>
                        </button>
                      </div>

                    </div>
                  </form>
                </td>
                <!--  <form method="post" th:action="@{/cart}">
                <input type="hidden" name="cartitemId" value="0" th:value="${item.id}"/>
                 <button type="submit">+</button>
                 </form>-->
                <td th:text="${{item.price}}">10 Euro</td>
                <td>
                  <form class="form-inline" method="post" th:action="@{/cart/setNewAmount}">

                    <div class="input-group mb-3">
                      <input type="hidden" name="cartitemId" th:value="${item.id}" />
                      <input class="form-control" type="hidden" name="newAmount" value="0">
                      <div class="input-group-append">
                        <button class="btn btn-outline-secondary" type="submit">Entfernen</button>
                      </div>

                    </div>
                  </form>
                </td>
              </tr>

              <tr>
                <td></td>
                <td></td>
                <td th:text="${cart.price}">
                </td>
                <td><a th:href="'/pay/' + ${domain.key}" type="submit">kaufen</a>
                </td>
              </tr>
            </div>
          </tbody>
        </table>
        <!--  <table class="ui celled table"><thead><tr><th>Titel</th><th>Anzahl</th><th>Preis</th><th></th></tr></thead><tbody>
            <tr th:each="item : ${domain.value} ">
                <td th:text="${item.productName}">Last Action Hero</td>
                <td > <table><tr><td><div th:text="${item.quantity}">10</div></td>
                <td><form method="post" action="/cart/add">
			      <input type="hidden" name="cartitemId" th:value="${item.id}"/>
			       
			      <input type="hidden" name="amount" value="1" placeholder="Anzahl">
			      <button type="submit" name="add" value="true">+</button> 
			      <button type="submit" name="add" value="false">-</button></form>
			    </td><!--  <form method="post" th:action="@{/cart}">
                <input type="hidden" name="cartitemId" value="0" th:value="${item.id}"/>
                 <button type="submit">+</button>
                 </form></tr></table> </td>
                <td th:text="${{item.price}}">10 Euro</td><td>
                <form method="post" th:action="@{/cart/remove}">
                <input type="hidden" name="cartitemId" th:value="${item.id}"/>
			    <button type="submit">entfernen</button>
			    </form>  </td>
            </tr>
          </tbody></table>-->
      </div>
      Gesamtpreis:<div th:text="${total}"></div>
      <div class="ui two column centered grid">

        <div class="value"><span th:text="${{total}}">1337</span></div>
        <form method="post" th:action="@{/cart/clear}"><button style="position:relative; top: 5px"
            class="btn btn-outline-primary float-left" type="submit">Warenkorb leeren</button></form>
        <!-- sec:authorize="hasRole('INDIVIDUAL')" -->
        <div class="container pb-5">
          <!--<form method="post" th:action="@{/pay}">
		       <input type="hidden" name="domain" th:value="none"/>
		       <button type="submit" style="position:relative; left: 5px; top: 5px" class="btn btn-outline-primary float-left">alles kaufen</button>
              </form>-->
          <a th:href="'/pay/_'">alles kaufen</a>
          <!-- <button class="btn btn-outline-primary" type="submit">kaufen</button> -->
        </div>

      </div>
      <br>
    </div>

  </div>
</body>

</html>